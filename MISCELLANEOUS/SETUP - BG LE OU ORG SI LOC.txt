---i Summary of BG, LE, OU and ORG

SELECT   
    HOU.BUSINESS_GROUP_ID "BG ID",
    LEGAL_ENTITY_IDENTIFIER "LE ID",
    XEP.NAME "LE Name",  
    OOD.OPERATING_UNIT "OU ID",
    HOU.NAME "OU Name",
    OOD.ORGANIZATION_ID "ORG ID",
    OOD.ORGANIZATION_NAME "ORG NAME",
    OOD.ORGANIZATION_CODE  "ORG CODE",
    GL.LEDGER_ID,
    GL.NAME "LEDGER NAME",
    HOU.SET_OF_BOOKS_ID,
    OOD.LEGAL_ENTITY
 FROM
    ORG_ORGANIZATION_DEFINITIONS OOD,
    XLE_ENTITY_PROFILES XEP,
    HR_OPERATING_UNITS HOU,
    GL_LEDGERS GL
WHERE 
   OOD.LEGAL_ENTITY = XEP.LEGAL_ENTITY_ID 
AND OOD.OPERATING_UNIT =  HOU.ORGANIZATION_ID
AND GL.LEDGER_ID = HOU.SET_OF_BOOKS_ID
ORDER BY 1,2,4;

---ii Analytical summary of BG, LE, OU and ORG 

SELECT XEP.LEGAL_ENTITY_IDENTIFIER "LE ID",
       XEP.NAME "LE Name",
       OOD.OPERATING_UNIT "OU ID",
       HOU.NAME "OU Name",
       OOD.ORGANIZATION_ID "ORG ID",
       OOD.ORGANIZATION_NAME "ORG NAME",
       OOD.ORGANIZATION_CODE "ORG CODE",
       COUNT (*)
       OVER (PARTITION BY LEGAL_ENTITY_IDENTIFIER
             ORDER BY LEGAL_ENTITY_IDENTIFIER,OOD.ORGANIZATION_ID
             ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)
          TOTAL_ORG,
       GL.LEDGER_ID,
       GL.NAME "LEDGER NAME",
       HOU.SET_OF_BOOKS_ID,
       OOD.LEGAL_ENTITY
  FROM ORG_ORGANIZATION_DEFINITIONS OOD,
       XLE_ENTITY_PROFILES XEP,
       HR_OPERATING_UNITS HOU,
       GL_LEDGERS GL
 WHERE     OOD.LEGAL_ENTITY = XEP.LEGAL_ENTITY_ID
       AND OOD.OPERATING_UNIT = HOU.ORGANIZATION_ID
       AND GL.LEDGER_ID = HOU.SET_OF_BOOKS_ID
;


---iii Summary of LE, OU , ORG and SI

SELECT   
    OOD.LEGAL_ENTITY,
    XEP.NAME "LE Name",  
    OOD.OPERATING_UNIT,
    HOU.NAME "OU Name",
    OOD.ORGANIZATION_ID,
    OOD.ORGANIZATION_CODE,
    OOD.ORGANIZATION_NAME "Inventory Org Name",
    MSI.SECONDARY_INVENTORY_NAME "Sub Inventory Name",
    MSI.DESCRIPTION
FROM
    ORG_ORGANIZATION_DEFINITIONS OOD,
    XLE_ENTITY_PROFILES XEP,
    HR_OPERATING_UNITS HOU,
    MTL_SECONDARY_INVENTORIES MSI
WHERE 
   OOD.LEGAL_ENTITY = XEP.LEGAL_ENTITY_ID 
AND OOD.OPERATING_UNIT =  HOU.ORGANIZATION_ID
AND  OOD.ORGANIZATION_ID = MSI.ORGANIZATION_ID
ORDER BY 1,3,5;

---iv Summary of LE, OU , ORG , SI and Locators

SELECT *
FROM MTL_SECONDARY_INVENTORIES
FETCH FIRST 15 ROWS ONLY;
SELECT   
    OOD.LEGAL_ENTITY,
    XEP.NAME "LE Name",  
    OOD.OPERATING_UNIT,
    HOU.NAME "OU Name",
    OOD.ORGANIZATION_ID,
    OOD.ORGANIZATION_CODE,
    OOD.ORGANIZATION_NAME "Inventory Org Name",
    MSI.SECONDARY_INVENTORY_NAME "Sub Inventory Name",
    MSI.DESCRIPTION "SI Description",
    MIL.INVENTORY_LOCATION_ID "Locators",
    MIL.DESCRIPTION "Locator Description"
FROM
    ORG_ORGANIZATION_DEFINITIONS OOD,
    XLE_ENTITY_PROFILES XEP,
    HR_OPERATING_UNITS HOU,
    MTL_SECONDARY_INVENTORIES MSI,
    MTL_ITEM_LOCATIONS MIL
WHERE 
   OOD.LEGAL_ENTITY = XEP.LEGAL_ENTITY_ID (+)
AND OOD.OPERATING_UNIT =  HOU.ORGANIZATION_ID
AND  OOD.ORGANIZATION_ID = MSI.ORGANIZATION_ID
AND MIL.SUBINVENTORY_CODE = MSI.SECONDARY_INVENTORY_NAME
ORDER BY 1,3,5;