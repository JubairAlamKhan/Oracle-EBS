
---(1) ITEMS, CATEGORY SET AND CATEGORY

SELECT 
    DISTINCT MICV.CATEGORY_CONCAT_SEGS,
    MICV.CATEGORY_SET_NAME,
    MSI.SEGMENT1|| '|' ||  MSI.SEGMENT2 ||  '|' || MSI.SEGMENT3|| '|' || MSI.SEGMENT4 ITEM_CODE,
    MSI.DESCRIPTION,
    MICV.CONTROL_LEVEL_DISP CONTROL_LEVEL,
    MICV.ORGANIZATION_ID,
    OOD.ORGANIZATION_CODE,
    OOD.ORGANIZATION_NAME,
    XEP.LEGAL_ENTITY_IDENTIFIER,
    XEP.NAME,
    MICV.CATEGORY_ID,
    MICV.INVENTORY_ITEM_ID
FROM 
    MTL_ITEM_CATEGORIES_V MICV,
    MTL_SYSTEM_ITEMS_B MSI,
    ORG_ORGANIZATION_DEFINITIONS OOD,
    XLE_ENTITY_PROFILES XEP
WHERE     
            1=1
    AND MICV.INVENTORY_ITEM_ID = MSI.INVENTORY_ITEM_ID  
    AND MICV.ORGANIZATION_ID = OOD.ORGANIZATION_ID  
    AND OOD.LEGAL_ENTITY = XEP.LEGAL_ENTITY_ID    
    AND (MICV.INVENTORY_ITEM_ID = :ITEM_ID OR MSI.SEGMENT1|| '|' ||  MSI.SEGMENT2 ||  '|' || MSI.SEGMENT3|| '|' || MSI.SEGMENT4 = :ITEM_CODE)
    AND (MICV.ORGANIZATION_ID = :ORGANIZATION_ID  OR OOD.ORGANIZATION_CODE = :ORGANIZATION_CODE OR :ORGANIZATION_ID IS NULL)
ORDER BY 
    MICV.CATEGORY_SET_NAME DESC;


---(2) CATEGORY SET

SELECT 
    DISTINCT CATEGORY_SET_ID,
    CATEGORY_SET_NAME "CATEGORY SET",
    DESCRIPTION
FROM
    MTL_CATEGORY_SETS;
    
---(3) CATEGORY

SELECT 
    DISTINCT SEGMENT1|| '|'|| SEGMENT2|| '|'|| SEGMENT3 ||  '|'|| SEGMENT4  ||  '|'|| SEGMENT5 CATEGORY
FROM 
    MTL_CATEGORIES_VL ;    
